<div class="salaires-container">
  <div class="header">
    <h1 class="title">{{ 'SALAIRES.TITLE' | translate }}</h1>
  </div>

  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>{{ 'MESSAGES.LOADING' | translate }}</p>
  </div>

  <div *ngIf="!loading && selectedBoat" class="content">
    <div class="tabs">
      <button class="tab-button" [class.active]="activeTab === 'ouvertes'" (click)="selectTab('ouvertes')">
        {{ 'SALAIRES.TABS.OPEN_TRIPS' | translate }}
        <span class="badge">{{ sortiesOuvertes.length }}</span>
      </button>
      <button class="tab-button" [class.active]="activeTab === 'historique'" (click)="selectTab('historique')">
        {{ 'SALAIRES.TABS.HISTORY' | translate }}
        <span class="badge">{{ sortiesCalculees.length }}</span>
      </button>
    </div>

    <div *ngIf="activeTab === 'ouvertes'" class="tab-content">
      <div class="section-card">
        <h2>{{ 'SORTIES.SELECTSORTIES' | translate }}</h2>
        <div *ngIf="sortiesOuvertes.length > 0; else noOpenTrips" class="sorties-list">
          <div *ngFor="let sortie of sortiesOuvertes" 
               class="sortie-item"
               [class.selected]="isSortieSelected(sortie.id!)"
               (click)="toggleSortie(sortie.id!)">
            <input type="checkbox" [checked]="isSortieSelected(sortie.id!)" (click)="$event.stopPropagation()">
            <div class="sortie-info">
              <strong>{{ sortie.destination }}</strong>
              <span>{{ formatDate(sortie.dateDepart) }} - {{ formatDate(sortie.dateRetour) }}</span>
            </div>
          </div>
        </div>
        <ng-template #noOpenTrips>
          <div class="no-data-small">
            <p>{{ 'SALAIRES.NO_OPEN_TRIPS' | translate }}</p>
          </div>
        </ng-template>
        
        <button class="btn btn-success btn-lg" 
               (click)="calculerSalaires()" 
               [disabled]="selectedSortiesIds.length === 0 || marins.length === 0">
          <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
          </svg>
          {{ 'SALAIRES.CALCULER' | translate }}
        </button>
      </div>
    </div>

    <div *ngIf="activeTab === 'historique'" class="tab-content">
      <div class="section-card">
        <h2>{{ 'SALAIRES.TABS.CALCULATED_TRIPS' | translate }}</h2>
        <div *ngIf="sortiesCalculees.length > 0; else noCalculatedTrips" class="sorties-list-history">
          <div *ngFor="let sortie of sortiesCalculees" class="sortie-item-history">
            <div class="sortie-info">
              <strong>{{ sortie.destination }}</strong>
              <span>{{ formatDate(sortie.dateDepart) }} - {{ formatDate(sortie.dateRetour) }}</span>
            </div>
            <button class="btn btn-secondary btn-sm" (click)="viewCalculDetails(sortie)">
              {{ 'COMMON.VIEW_DETAILS' | translate }}
            </button>
          </div>
        </div>
        <ng-template #noCalculatedTrips>
          <div class="no-data-small">
            <p>{{ 'SALAIRES.NO_CALCULATED_TRIPS' | translate }}</p>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
