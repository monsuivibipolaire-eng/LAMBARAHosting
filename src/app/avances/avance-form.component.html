<div class="form-container">
  <div class="form-header">
    <button class="btn-back" (click)="goBack()">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
      </svg>
      {{ 'SAILORS.BACK' | translate }}
    </button>
    <h1 class="form-title">{{ pageTitle | translate }}</h1>
  </div>

  <form [formGroup]="form" (ngSubmit)="onSubmit()" class="form">
    <div class="form-grid">

      <!-- Champ Marin -->
      <div class="form-group">
        <label class="form-label" for="marinId">{{ 'SAILORS.TITLE' | translate }} *</label>
        <select id="marinId" formControlName="marinId" class="form-input"
                [class.error]="form.get('marinId')?.invalid && form.get('marinId')?.touched">
          <option value="" disabled>{{ 'SAILORS.SELECT_SAILOR' | translate }}</option>
          <option *ngFor="let marin of marins$ | async" [value]="marin.id">
            {{ marin.prenom }} {{ marin.nom }} - {{ 'SAILORS.FUNCTION_TYPE.' + marin.fonction.toUpperCase() | translate }}
          </option>
        </select>
        <span class="error-message" *ngIf="form.get('marinId')?.hasError('required') && form.get('marinId')?.touched">
          {{ 'FORM.REQUIRED' | translate }}
        </span>
      </div>

      <!-- Champ Montant -->
      <div class="form-group">
        <label class="form-label" for="montant">{{ 'COMMON.AMOUNT_D_T' | translate }} *</label>
        <input id="montant" type="number" formControlName="montant" class="form-input"
               placeholder="0.00" step="0.01" min="0" autocomplete="off"
               [class.error]="form.get('montant')?.invalid && form.get('montant')?.touched"/>
        <span class="error-message" *ngIf="form.get('montant')?.hasError('required') && form.get('montant')?.touched">
            {{ 'FORM.REQUIRED' | translate }}
        </span>
         <span class="error-message" *ngIf="form.get('montant')?.hasError('min') && form.get('montant')?.touched">
             {{ 'AVANCES.AMOUNT_POSITIVE' | translate }}
        </span>
        <div class="input-helper">{{ 'COMMON.AMOUNT_IN_TND' | translate }}</div>
      </div>

      <!-- Champ Date -->
      <div class="form-group">
        <label class="form-label" for="dateAvance">{{ 'COMMON.DATE' | translate }} *</label>
        <input id="dateAvance" type="date" formControlName="dateAvance" class="form-input"
               [class.error]="form.get('dateAvance')?.invalid && form.get('dateAvance')?.touched"/>
         <span class="error-message" *ngIf="form.get('dateAvance')?.hasError('required') && form.get('dateAvance')?.touched">
             {{ 'FORM.REQUIRED' | translate }}
        </span>
      </div>

       <!-- Champ Description -->
      <div class="form-group full-width">
        <label class="form-label" for="description">{{ 'COMMON.DESCRIPTION' | translate }}</label>
        <textarea id="description" formControlName="description" class="form-input" rows="3"
                  [placeholder]="'COMMON.DESCRIPTION_OPTIONAL' | translate"></textarea>
      </div>

    </div>

    <div class="form-actions">
      <button type="button" (click)="goBack()" class="btn btn-secondary" [disabled]="loading">
        {{ 'FORM.CANCEL' | translate }}
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">
        {{ loading ? ('MESSAGES.SAVING' | translate) : ((isEditMode ? 'FORM.EDIT' : 'FORM.ADD') | translate) }}
      </button>
    </div>
  </form>
</div>
