import{a as D}from"./chunk-5SMMQZVJ.js";import{Dc as F,Ec as b,Fc as h,L as B,R as f,V as s,a as P,b as V,f as r,p as C,sc as m,t as q,u as E,uc as a,vc as p,wc as v,xc as n,yc as u,zc as o}from"./chunk-S7C4YWPX.js";var c=class c{constructor(t,e){this.firestore=t;this.finEvents=e;this.collectionName="depenses"}getDepensesBySortie(t){let e=n(this.firestore,this.collectionName),i=F(e,h("sortieId","==",t));return a(i,{idField:"id"})}getDepense(t){let e=o(this.firestore,this.collectionName,t);return p(e,{idField:"id"})}addDepense(t){return r(this,null,function*(){let e=n(this.firestore,this.collectionName),i=yield v(e,t);return this.finEvents.notifyFinancialChange(),i.id})}updateDepense(t,e){return r(this,null,function*(){let i=o(this.firestore,this.collectionName,t);yield b(i,e),this.finEvents.notifyFinancialChange()})}deleteDepense(t){return r(this,null,function*(){let e=o(this.firestore,this.collectionName,t);yield u(e),this.finEvents.notifyFinancialChange()})}};c.\u0275fac=function(e){return new(e||c)(s(m),s(D))},c.\u0275prov=f({token:c,factory:c.\u0275fac,providedIn:"root"});var g=c;var l=class l{constructor(t,e){this.firestore=t;this.finEvents=e;this.collectionName="factures-vente"}getFacturesBySortie(t){let e=n(this.firestore,this.collectionName),i=F(e,h("sortieId","==",t));return a(i,{idField:"id"})}getFacture(t){let e=o(this.firestore,this.collectionName,t);return p(e,{idField:"id"})}addFacture(t){return r(this,null,function*(){let e=n(this.firestore,this.collectionName),i=yield v(e,t);return this.finEvents.notifyFinancialChange(),i.id})}updateFacture(t,e){return r(this,null,function*(){let i=o(this.firestore,this.collectionName,t);yield b(i,e),this.finEvents.notifyFinancialChange()})}deleteFacture(t){return r(this,null,function*(){let e=o(this.firestore,this.collectionName,t);yield u(e),this.finEvents.notifyFinancialChange()})}};l.\u0275fac=function(e){return new(e||l)(s(m),s(D))},l.\u0275prov=f({token:l,factory:l.\u0275fac,providedIn:"root"});var S=l;var d=class d{constructor(t,e,i){this.firestore=t;this.depenseService=e;this.factureVenteService=i;this.sortiesCollection=n(this.firestore,"sorties")}getSorties(){return a(this.sortiesCollection,{idField:"id"})}getSortie(t){let e=o(this.firestore,"sorties",t);return p(e,{idField:"id"})}getSortiesByBateau(t){let e=F(this.sortiesCollection,h("bateauId","==",t));return a(e,{idField:"id"}).pipe(B(j=>{if(j.length===0)return C([]);let R=j.map(y=>{let L=this.depenseService.getDepensesBySortie(y.id),M=this.factureVenteService.getFacturesBySortie(y.id);return E([L,M]).pipe(q(([I,N])=>{let z=I.reduce((O,w)=>O+w.montant,0),A=N.reduce((O,w)=>O+w.montant,0);return V(P({},y),{depenses:I,factures:N,totalDepenses:z,totalFactures:A})}))});return E(R)}))}addSortie(t){return r(this,null,function*(){return(yield v(this.sortiesCollection,t)).id})}updateSortie(t,e){return r(this,null,function*(){let i=o(this.firestore,"sorties",t);yield b(i,e)})}deleteSortie(t){return r(this,null,function*(){let e=o(this.firestore,"sorties",t);yield u(e)})}};d.\u0275fac=function(e){return new(e||d)(s(m),s(g),s(S))},d.\u0275prov=f({token:d,factory:d.\u0275fac,providedIn:"root"});var k=d;export{g as a,S as b,k as c};
